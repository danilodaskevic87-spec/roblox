<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–°–∞–π—Ç</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="icon" href="favicon.png">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{margin:0;font-family:Arial;background:#0b1220;color:#e5e7eb}
.hidden{display:none}
.container{max-width:900px;margin:40px auto;padding:20px}
.card{background:#020617;border-radius:22px;padding:25px;margin-bottom:25px}
input,select,button{width:100%;padding:14px;margin-top:10px;border-radius:14px;border:none}
input,select{background:#0f172a;color:white;border:1px solid #1e293b}
button{background:#6366f1;color:white;font-weight:bold;cursor:pointer}
.error{color:#f87171;font-size:14px;margin-top:6px}
</style>
</head>
<body>

<div class="container">

<div class="card" id="loginView">
  <h2>–í—Ö—ñ–¥</h2>
  <input id="loginLogin" placeholder="–ù—ñ–∫ –∞–±–æ ID">
  <input id="loginPassword" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button id="loginBtn">–£–≤—ñ–π—Ç–∏</button>
  <div class="error" id="loginError"></div>
  <p style="text-align:center">
    <a href="#" id="goRegister" style="color:#38bdf8">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
  </p>
</div>

<div class="card hidden" id="registerView">
  <h2>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>
  <input id="regLogin" placeholder="–ù—ñ–∫ –∞–±–æ ID">
  <input id="regPassword" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button id="registerBtn">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
  <div class="error" id="regError"></div>
  <p style="text-align:center">
    <a href="#" id="goLogin" style="color:#38bdf8">–ù–∞–∑–∞–¥</a>
  </p>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* üîë SUPABASE */
  const supabase = window.supabase.createClient(
    "https://yknskbeqyahkxwceqflr.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlrbnNrYmVxeWFoa3h3Y2VxZmxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzA1OTAsImV4cCI6MjA4NDU0NjU5MH0.UaGcGRMdcPHv9bujNEtSjoL6OYy6XnmpxgWR9W2029M"
  );

  const loginView = document.getElementById("loginView");
  const registerView = document.getElementById("registerView");

  /* –ü–ï–†–ï–•–û–î–ò */
  document.getElementById("goRegister").addEventListener("click", e=>{
    e.preventDefault();
    loginView.classList.add("hidden");
    registerView.classList.remove("hidden");
  });

  document.getElementById("goLogin").addEventListener("click", e=>{
    e.preventDefault();
    registerView.classList.add("hidden");
    loginView.classList.remove("hidden");
  });

  /* –õ–û–ì–Ü–ù */
  document.getElementById("loginBtn").addEventListener("click", async ()=>{
    const login = loginLogin.value.trim();
    const pass = loginPassword.value;
    loginError.textContent="";

    const { data } = await supabase
      .from("users")
      .select("id,password")
      .eq("login", login)
      .single();

    if(!data || data.password !== pass){
      loginError.textContent="–ù–µ–≤—ñ—Ä–Ω—ñ –¥–∞–Ω—ñ";
      return;
    }

    alert("–õ–æ–≥—ñ–Ω —É—Å–ø—ñ—à–Ω–∏–π");
  });

  /* –†–ï–Ñ–°–¢–†–ê–¶–Ü–Ø */
  document.getElementById("registerBtn").addEventListener("click", async ()=>{
    const l = regLogin.value.trim();
    const p = regPassword.value;
    regError.textContent="";

    const { error } = await supabase
      .from("users")
      .insert({ login:l, password:p });

    if(error){
      regError.textContent="–õ–æ–≥—ñ–Ω –∑–∞–π–Ω—è—Ç–∏–π";
      return;
    }

    alert("–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞");
  });

});
</script>
</body>
</html>
